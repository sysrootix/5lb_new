# ๐ณ ะะฐัะฝะธัะต ะทะดะตัั - Docker Setup ะดะปั 5LB

## โ ะงัะพ ะณะพัะพะฒะพ

ะัะพะตะบั ะฟะพะปะฝะพัััั ะณะพัะพะฒ ะบ ะทะฐะฟััะบั ะฒ Docker ะบะพะฝัะตะนะฝะตัะฐั. ะกะพะทะดะฐะฝั:

- โ Docker Compose ะบะพะฝัะธะณััะฐัะธะธ (production ะธ development)
- โ Dockerfiles ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ
- โ Nginx ะบะพะฝัะธะณััะฐัะธะธ ะดะปั reverse proxy
- โ ะกะบัะธะฟัั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ (ะดะตะฟะปะพะน, ะฑัะบะฐะฟ, ะฒะพัััะฐะฝะพะฒะปะตะฝะธะต)
- โ ะะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั

## ๐ ะัััััะน ะทะฐะฟััะบ (3 ัะฐะณะฐ)

### 1. ะกะพะทะดะฐะนัะต .env ัะฐะนะป

```bash
cp .env.example .env
nano .env
```

ะะฐะฟะพะปะฝะธัะต ะพะฑัะทะฐัะตะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต:
```env
POSTGRES_PASSWORD=ะฒะฐั_ะฝะฐะดะตะถะฝัะน_ะฟะฐัะพะปั
JWT_SECRET=ะฒะฐั_jwt_ัะตะบัะตั_ะผะธะฝะธะผัะผ_32_ัะธะผะฒะพะปะฐ
TELEGRAM_BOT_TOKEN=ะฒะฐั_ัะพะบะตะฝ_ะฑะพัะฐ
```

### 2. ะะฐะฟัััะธัะต

```bash
./docker-deploy.sh
```

### 3. ะัะพะฒะตัััะต

```bash
docker-compose ps
docker-compose logs -f
```

## ๐ ะะพะบัะผะตะฝัะฐัะธั

ะัะฑะตัะธัะต ะฝัะถะฝัะน ะดะพะบัะผะตะฝั:

1. **[DOCKER-QUICK-START.md](./DOCKER-QUICK-START.md)** โญ
   - ะกะฐะผัะน ะฑัััััะน ััะฐัั
   - ะะปั ัะตั, ะบัะพ ัะพัะตั ะทะฐะฟัััะธัั ะฟััะผะพ ัะตะนัะฐั
   - 5 ะผะธะฝัั ะฝะฐ ััะตะฝะธะต

2. **[README-DOCKER.md](./README-DOCKER.md)** ๐
   - ะะปะฐะฒะฝัะน README
   - ะะฑะทะพั ะฒัะตั ะบะพะผะฟะพะฝะตะฝัะพะฒ
   - ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั

3. **[DOCKER.md](./DOCKER.md)** ๐
   - ะะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั
   - ะะตัะฐะปัะฝัะต ะธะฝััััะบัะธะธ
   - Troubleshooting

4. **[DOCKER-FILES-SUMMARY.md](./DOCKER-FILES-SUMMARY.md)** ๐
   - ะกะฟะธัะพะบ ะฒัะตั ัะพะทะดะฐะฝะฝัั ัะฐะนะปะพะฒ
   - ะกัััะบัััะฐ ะฟัะพะตะบัะฐ
   - ะงัะพ ะณะดะต ะฝะฐัะพะดะธััั

## ๐ ะะพัััะฟ ะบ ะฟัะธะปะพะถะตะฝะธั

ะะพัะปะต ะทะฐะฟััะบะฐ ะฟัะธะปะพะถะตะฝะธะต ะฑัะดะตั ะดะพัััะฟะฝะพ ะฝะฐ:

- **Main App**: http://app.5lb.pro (ะธะปะธ http://localhost)
- **CRM**: http://crm.5lb.pro

## ๐ ะะธะณัะฐัะธั ั ัััะตััะฒัััะตะณะพ ัะตัะฒะตัะฐ

ะัะปะธ ั ะฒะฐั ะตััั ัะฐะฑะพัะฐััะธะน ัะตัะฒะตั ะธ ะฝัะถะฝะพ ะฟะตัะตะฝะตััะธ ะฝะฐ ะฝะพะฒัะน:

### ะะฐ ััะฐัะพะผ ัะตัะฒะตัะต:

```bash
# ะกะพะทะดะฐะนัะต ะฑัะบะฐะฟ ะะ
pg_dump -U postgres 5lb_db > /tmp/5lb_backup.sql

# ะกะบะพะฟะธััะนัะต ะฝะฐ ะฝะพะฒัะน ัะตัะฒะตั
scp /tmp/5lb_backup.sql root@ะฝะพะฒัะน_ัะตัะฒะตั:/root/
```

### ะะฐ ะฝะพะฒะพะผ ัะตัะฒะตัะต:

```bash
# ะะตัะตะนะดะธัะต ะฒ ะดะธัะตะบัะพัะธั ะฟัะพะตะบัะฐ
cd /root/5lb

# ะะฐัััะพะนัะต .env
cp .env.example .env
nano .env

# ะะฐะฟัััะธัะต ัะพะปัะบะพ PostgreSQL
docker-compose up -d postgres

# ะะพะถะดะธัะตัั ะณะพัะพะฒะฝะพััะธ (15 ัะตะบ)
sleep 15

# ะะพัััะฐะฝะพะฒะธัะต ะฑะฐะทั
./docker-restore.sh /root/5lb_backup.sql

# ะะฐะฟัััะธัะต ะฒัะต ัะตัะฒะธัั
docker-compose up -d

# ะัะพะฒะตัััะต
docker-compose ps
```

## ๐๏ธ ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั

```bash
# ะัะพัะผะพัั ะปะพะณะพะฒ
docker-compose logs -f

# ะกัะฐััั ัะตัะฒะธัะพะฒ
docker-compose ps

# ะะตัะตะทะฐะฟััะบ ัะตัะฒะธัะฐ
docker-compose restart backend

# ะััะฐะฝะพะฒะบะฐ ะฒัะตั ัะตัะฒะธัะพะฒ
docker-compose down

# ะัะบะฐะฟ ะฑะฐะทั ะดะฐะฝะฝัั
./docker-backup.sh

# ะะพะฝะธัะพัะธะฝะณ ัะตััััะพะฒ
docker stats
```

## ๐ SSL ัะตััะธัะธะบะฐัั (ะดะปั production)

ะะพัะปะต ะทะฐะฟััะบะฐ ะฝะฐัััะพะนัะต SSL:

```bash
# ะฃััะฐะฝะพะฒะธัะต certbot
apt install certbot -y

# ะััะฐะฝะพะฒะธัะต nginx ะฒัะตะผะตะฝะฝะพ
docker-compose stop nginx

# ะะพะปััะธัะต ัะตััะธัะธะบะฐัั
certbot certonly --standalone -d app.5lb.pro -d crm.5lb.pro

# ะะฐัะบะพะผะผะตะฝัะธััะนัะต HTTPS ะฑะปะพะบะธ ะฒ ะบะพะฝัะธะณะฐั
nano nginx/docker-app.conf     # ะะฐัะบะพะผะผะตะฝัะธััะนัะต server { listen 443 ssl... }
nano nginx/docker-crm.conf     # ะะฐัะบะพะผะผะตะฝัะธััะนัะต server { listen 443 ssl... }

# ะะฐะฟัััะธัะต nginx ะพะฑัะฐัะฝะพ
docker-compose start nginx
```

## ๐ ะัะปะธ ััะพ-ัะพ ะฝะต ัะฐะฑะพัะฐะตั

### ะจะฐะณ 1: ะัะพะฒะตัััะต ะปะพะณะธ

```bash
docker-compose logs -f
```

### ะจะฐะณ 2: ะัะพะฒะตัััะต ััะฐััั

```bash
docker-compose ps
```

### ะจะฐะณ 3: ะะตัะตัะพะฑะตัะธัะต

```bash
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

### ะจะฐะณ 4: ะัะพะฒะตัััะต ะฟะพััั

ะฃะฑะตะดะธัะตัั, ััะพ ะฟะพััั ะฝะต ะทะฐะฝััั:

```bash
netstat -tulpn | grep -E '(80|443|5432|60000|60001)'

# ะัะปะธ PM2 ะทะฐะฟััะตะฝ - ะพััะฐะฝะพะฒะธัะต ะตะณะพ
pm2 stop all
pm2 delete all
```

## ๐ ะกัััะบัััะฐ ัะฐะนะปะพะฒ

```
5lb/
โโโ ๐ START-HERE-DOCKER.md      โญ ะะซ ะะะะกะฌ
โโโ ๐ DOCKER-QUICK-START.md     ะัััััะน ััะฐัั
โโโ ๐ README-DOCKER.md          ะะปะฐะฒะฝัะน README
โโโ ๐ DOCKER.md                 ะะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั
โโโ ๐ DOCKER-FILES-SUMMARY.md   ะกะฟะธัะพะบ ัะฐะนะปะพะฒ
โ
โโโ ๐ณ docker-compose.yml        Production
โโโ ๐ณ docker-compose.dev.yml    Development
โโโ ๐ง .env.example              ะจะฐะฑะปะพะฝ ะฟะตัะตะผะตะฝะฝัั
โ
โโโ ๐ docker-deploy.sh          ะกะบัะธะฟั ะดะตะฟะปะพั
โโโ ๐พ docker-backup.sh          ะกะบัะธะฟั ะฑัะบะฐะฟะฐ
โโโ ๐ docker-restore.sh         ะกะบัะธะฟั ะฒะพัััะฐะฝะพะฒะปะตะฝะธั
โ
โโโ backend/
โ   โโโ ๐ณ Dockerfile            Production
โ   โโโ ๐ณ Dockerfile.dev        Development
โ
โโโ frontend/
โ   โโโ ๐ณ Dockerfile            Production
โ
โโโ crm/
โ   โโโ ๐ณ Dockerfile.backend
โ   โโโ ๐ณ Dockerfile.frontend
โ
โโโ nginx/
    โโโ โ๏ธ  docker-nginx.conf     ะัะฝะพะฒะฝะฐั ะบะพะฝัะธะณััะฐัะธั
    โโโ โ๏ธ  docker-app.conf       App ะบะพะฝัะธะณััะฐัะธั
    โโโ โ๏ธ  docker-crm.conf       CRM ะบะพะฝัะธะณััะฐัะธั
```

## ๐ก ะกะพะฒะตัั

1. **ะกะฝะฐัะฐะปะฐ ะฟัะพัะตััะธััะนัะต ะปะพะบะฐะปัะฝะพ** - ะทะฐะฟัััะธัะต ะฝะฐ ัะฒะพะตะน ะผะฐัะธะฝะต ะฟะตัะตะด ะดะตะฟะปะพะตะผ ะฝะฐ production
2. **ะะตะปะฐะนัะต ะฑัะบะฐะฟั** - ะธัะฟะพะปัะทัะนัะต `./docker-backup.sh` ัะตะณัะปััะฝะพ
3. **ะะพะฝะธัะพัััะต ัะตััััั** - ะธัะฟะพะปัะทัะนัะต `docker stats`
4. **ะงะธัะฐะนัะต ะปะพะณะธ** - `docker-compose logs -f` ะฟะพะผะพะถะตั ะฝะฐะนัะธ ะฟัะพะฑะปะตะผั
5. **ะะฑะฝะพะฒะปัะนัะต ะพะฑัะฐะทั** - ะฟะตัะธะพะดะธัะตัะบะธ ะฟะตัะตัะพะฑะธัะฐะนัะต ั `--no-cache`

## ๐ฏ ะกะปะตะดัััะธะต ัะฐะณะธ

1. โ ะกะพะทะดะฐัั `.env` ัะฐะนะป
2. โ ะะฐะฟัััะธัั ัะตัะตะท `./docker-deploy.sh`
3. โญ๏ธ ะะฐัััะพะธัั DNS ะดะปั ะดะพะผะตะฝะพะฒ
4. โญ๏ธ ะะพะปััะธัั SSL ัะตััะธัะธะบะฐัั
5. โญ๏ธ ะะฐัััะพะธัั ะฐะฒัะพะผะฐัะธัะตัะบะธะต ะฑัะบะฐะฟั (cron)
6. โญ๏ธ ะะฐัััะพะธัั ะผะพะฝะธัะพัะธะฝะณ

## โ ะัะถะฝะฐ ะฟะพะผะพัั?

- **ะัััััะต ะพัะฒะตัั**: [DOCKER-QUICK-START.md](./DOCKER-QUICK-START.md)
- **ะะพะดัะพะฑะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั**: [DOCKER.md](./DOCKER.md)
- **ะกะฟะธัะพะบ ัะฐะนะปะพะฒ**: [DOCKER-FILES-SUMMARY.md](./DOCKER-FILES-SUMMARY.md)

## โจ ะัะพะฑะตะฝะฝะพััะธ

- ๐ ะัััััะน ะดะตะฟะปะพะน ะพะดะฝะพะน ะบะพะผะฐะฝะดะพะน
- ๐ ะะฒัะพะผะฐัะธัะตัะบะธะต ะผะธะณัะฐัะธะธ Prisma
- ๐พ ะะฒัะพะผะฐัะธัะตัะบะธะต ะฑัะบะฐะฟั
- ๐ฅ Health checks ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ
- ๐ ะะพัะพะฒะฝะพััั ะบ SSL
- ๐ ะะพะฝะธัะพัะธะฝะณ ัะตัะตะท Docker
- ๐ง Development ัะตะถะธะผ ั hot reload

---

**ะะพัะพะฒะพ ะบ ะทะฐะฟััะบั!** ๐

ะัะพััะพ ะทะฐะฟัััะธัะต `./docker-deploy.sh` ะธ ะฒัะต ะทะฐัะฐะฑะพัะฐะตั.
