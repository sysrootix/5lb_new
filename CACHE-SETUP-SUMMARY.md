# ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. **PWA Service Worker –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** (`frontend/vite.config.ts`)
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–µ—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ **180 –¥–Ω–µ–π** (200 —Ñ–∞–π–ª–æ–≤ max)
- ‚úÖ –í–Ω–µ—à–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–µ—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ **90 –¥–Ω–µ–π** (500 —Ñ–∞–π–ª–æ–≤ max)
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ —É–≤–µ–ª–∏—á–µ–Ω –¥–æ **10MB**
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤: png, jpg, jpeg, webp, svg, gif, avif
- ‚úÖ –°—Ç—Ä–∞—Ç–µ–≥–∏—è `CacheFirst` ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ—Ä—É—Ç—Å—è –∏–∑ –∫–µ—à–∞, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã

### 2. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç OptimizedImage** (`frontend/src/components/OptimizedImage.tsx`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π **lazy loading** —Å Intersection Observer
- ‚úÖ **Shimmer skeleton** –ø–æ–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä—É–∑–∏—Ç—Å—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **placeholder** –ø—Ä–∏ –æ—à–∏–±–∫–µ
- ‚úÖ –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
- ‚úÖ `crossOrigin="anonymous"` –¥–ª—è PWA

### 3. **–£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∫–µ—à–∞** (`frontend/src/utils/imageCache.ts`)
- ‚úÖ `preloadImage(url)` ‚Äî –ø—Ä–µ–ª–æ–∞–¥ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ `preloadImages([urls])` ‚Äî –ø—Ä–µ–ª–æ–∞–¥ –º–∞—Å—Å–∏–≤–∞
- ‚úÖ `preloadCriticalImages()` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–µ–ª–æ–∞–¥ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- ‚úÖ `getCacheSize()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ `clearImageCache()` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –∫–µ—à
- ‚úÖ `isImageCached(url)` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–æ –ª–∏

### 4. **HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** (`backend/src/middleware/cacheHeaders.ts`)
- ‚úÖ `Cache-Control: public, max-age=31536000, immutable` –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ Middleware –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (`/uploads`)
- ‚úÖ `Access-Control-Allow-Origin: *` –¥–ª—è –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ ETag –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–µ—à–∞

### 5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–µ–ª–æ–∞–¥** (`frontend/src/main.tsx`)
- ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
  - `/logo.svg`
  - `/images/global-bg.svg`
  - `/images/background-pattern.svg`

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```tsx
import { OptimizedImage } from '@/components/OptimizedImage';

<OptimizedImage
  src="https://example.com/image.jpg"
  alt="–û–ø–∏—Å–∞–Ω–∏–µ"
  className="w-full h-auto"
/>
```

### –° placeholder

```tsx
<OptimizedImage
  src={product.imageUrl}
  alt={product.name}
  placeholder="/images/no-image.svg"
  className="w-full h-48 object-cover"
  lazy={true}
/>
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–±–µ–∑ lazy)

```tsx
<OptimizedImage
  src="/logo.svg"
  alt="Logo"
  lazy={false}
  className="h-8"
/>
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –ø—Ä–µ–ª–æ–∞–¥

```tsx
import { preloadImages } from '@/utils/imageCache';

useEffect(() => {
  preloadImages(['/img1.jpg', '/img2.jpg']);
}, []);
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –í Chrome DevTools

**Application ‚Üí Cache Storage**
- `local-images-cache` ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `external-images-cache` ‚Äî –≤–Ω–µ—à–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**Network ‚Üí Size –∫–æ–ª–æ–Ω–∫–∞**
- `(disk cache)` –∏–ª–∏ `(from ServiceWorker)` ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –∫–µ—à–∞

### 2. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

```javascript
// –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫–µ—à–∏
await caches.keys()

// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
const cache = await caches.open('external-images-cache')
const keys = await cache.keys()
console.log('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∫–µ—à–µ:', keys.length)
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
curl -I https://5lb.online/uploads/avatar.jpg

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏:
# Cache-Control: public, max-age=31536000, immutable
# Access-Control-Allow-Origin: *
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:
- ‚ö° **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä—É–∑—è—Ç—Å—è –∏–∑ –∫–µ—à–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- üíæ **–≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞** ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ —Ä–∞—Å—Ö–æ–¥—É—é—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- üì± **–†–∞–±–æ—Ç–∞ –æ—Ñ–ª–∞–π–Ω** ‚Äî –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ —Å–µ—Ç–∏
- üé® **–õ—É—á—à–∏–π UX** ‚Äî shimmer skeleton –≤–º–µ—Å—Ç–æ –ø—É—Å—Ç—ã—Ö –º–µ—Å—Ç
- üöÄ **Lazy loading** ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä—É–∑—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- üìñ `IMAGE-CACHING.md` ‚Äî –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—é
- üìù `EXAMPLE-OPTIMIZED-IMAGE.md` ‚Äî –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è OptimizedImage

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. **–ó–∞–º–µ–Ω–∏—Ç—å `<img>` –Ω–∞ `<OptimizedImage`** –≤ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:
   - `HomeBanner.tsx` (–±–∞–Ω–Ω–µ—Ä—ã)
   - –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
   - –ê–≤–∞—Ç–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–µ—Ç–∞–ª–µ–π

2. **–î–æ–±–∞–≤–∏—Ç—å placeholder –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –≤ `public/images/`:
   - `placeholder-product.svg` ‚Äî –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
   - `placeholder-avatar.svg` ‚Äî –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤
   - `no-image.svg` ‚Äî –æ–±—â–∏–π fallback

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å pr–µ–ª–æ–∞–¥** –≤–∞–∂–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ `imageCache.ts`

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–µ—à–∞** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ Settings –¥–ª—è:
   - –ü—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞ –∫–µ—à–∞
   - –û—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å frontend
cd frontend && npm run build

# 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
pm2 restart 5lb-backend

# 3. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DevTools ‚Üí Application ‚Üí Cache Storage
# 5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –≥—Ä—É–∑–∏—Ç—å—Å—è –∏–∑ –∫–µ—à–∞
```

---

üéâ **–ì–æ—Ç–æ–≤–æ!** –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –∫–µ—à–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
